2023-03-20 02:21:38.445 <TRACE> savnet_ec: Initializing
2023-03-20 02:21:38.445 <TRACE> savnet_ed: Initializing
2023-03-20 02:21:38.445 <ERR> from interface 1:lo
2023-03-20 02:21:38.445 <ERR> KIF: Malformed message received (IPV6/missing IFA_ADDRESS)
2023-03-20 02:21:38.445 <ERR> from interface 484:e_b
2023-03-20 02:21:38.445 <ERR> KIF: Malformed message received (IPV6/missing IFA_ADDRESS)
2023-03-20 02:21:38.445 <ERR> from interface 488:e_d
2023-03-20 02:21:38.445 <ERR> KIF: Malformed message received (IPV6/missing IFA_ADDRESS)
2023-03-20 02:21:38.445 <TRACE> savnet_ec: Starting
2023-03-20 02:21:38.445 <DBG> link [savnet_ec] meta sent
2023-03-20 02:21:38.445 <TRACE> savnet_ec: Protocol state changed to start
2023-03-20 02:21:38.445 <TRACE> savnet_ed: Starting
2023-03-20 02:21:38.445 <DBG> link [savnet_ed] meta sent
2023-03-20 02:21:38.445 <TRACE> savnet_ed: Protocol state changed to start
2023-03-20 02:21:38.445 <INFO> Started
BGP: Got lock
2023-03-20 02:21:38.452 <TRACE> savnet_ed: Started
2023-03-20 02:21:38.452 <TRACE> savnet_ed: Connect delayed by 5 seconds
BGP: Got lock
2023-03-20 02:21:38.452 <TRACE> savnet_ec: Started
2023-03-20 02:21:38.452 <TRACE> savnet_ec: Connect delayed by 5 seconds
BGP: Incoming connection from 10.0.7.1 port 39917
2023-03-20 02:21:42.800 <TRACE> savnet_ed: Incoming connection from 10.0.7.1 (port 39917) accepted
BGP: Sending open
2023-03-20 02:21:42.800 <TRACE> savnet_ed: Sending OPEN(ver=4,as=65503,hold=240,id=0a000502)
2023-03-20 02:21:42.800 <TRACE> savnet_ed: Sending OPEN content Capability Code: 1, AFI: 1,SAFI: 1
2023-03-20 02:21:42.800 <TRACE> savnet_ed: Got OPEN(as=65502,hold=240,id=10.0.4.2)
2023-03-20 02:21:42.800 <TRACE> savnet_ed: Got OPEN content Capability Code: 1, AFI: 1, SAFI: 1
BGP: Closing connection
BGP: Decision start
2023-03-20 02:21:42.800 <TRACE> savnet_ed: Sending KEEPALIVE
2023-03-20 02:21:42.800 <TRACE> savnet_ed: Got KEEPALIVE
2023-03-20 02:21:42.800 <TRACE> savnet_ed: BGP session established
2023-03-20 02:21:42.800 <TRACE> savnet_ed: Protocol state changed to up
2023-03-20 02:21:42.800 <DBG> link [savnet_ed] up sent
2023-03-20 02:21:42.802 <TRACE> savnet_ed.savnet4 < filtered out 10.0.7.0/24 488L 6G unicast
2023-03-20 02:21:42.802 <TRACE> savnet_ed.savnet4 < filtered out 10.0.5.0/24 484L 5G unicast
2023-03-20 02:21:42.802 <TRACE> savnet_ed.savnet4 < filtered out 192.168.4.0/24 0L 4G blackhole
2023-03-20 02:21:42.802 <TRACE> savnet_ed.ipv4 < added 10.0.7.0/24 488L 6G unicast
2023-03-20 02:21:42.802 <TRACE> savnet_ed.ipv4 < added 10.0.5.0/24 484L 5G unicast
2023-03-20 02:21:42.802 <TRACE> savnet_ed.ipv4 < added 192.168.4.0/24 0L 4G blackhole
2023-03-20 02:21:43.243 <TRACE> savnet_ed: Got UPDATE
2023-03-20 02:21:43.243 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:43.243 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:43.243 <TRACE> savnet_ed: Got END-OF-RIB
2023-03-20 02:21:43.243 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.243 <TRACE> savnet_ed: Sending END-OF-RIB
2023-03-20 02:21:43.243 <TRACE> savnet_ed: Sending UPDATE
2023-03-20 02:21:43.243 <TRACE> savnet_ed: Sending END-OF-RIB
2023-03-20 02:21:43.243 <TRACE> savnet_ed: Got UPDATE
2023-03-20 02:21:43.243 <DBG> 
ip_unreach_len: 0
ip_reach_len: 16
2023-03-20 02:21:43.243 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:43.243 <TRACE> savnet_ed.ipv4 > added 10.0.7.0/24 0L 7G unicast
2023-03-20 02:21:43.243 <TRACE> savnet_ed.ipv4 > added [best] 10.0.4.0/24 0L 7G unicast
2023-03-20 02:21:43.243 <TRACE> savnet_ed.savnet4 < rejected by protocol 10.0.4.0/24 0L 7G unicast
2023-03-20 02:21:43.243 <TRACE> savnet_ed.ipv4 < rejected by protocol 10.0.4.0/24 0L 7G unicast
2023-03-20 02:21:43.243 <TRACE> savnet_ed.ipv4 > added [best] 192.168.2.0/24 0L 7G unicast
2023-03-20 02:21:43.243 <TRACE> savnet_ed.savnet4 < rejected by protocol 192.168.2.0/24 0L 7G unicast
2023-03-20 02:21:43.243 <TRACE> savnet_ed.ipv4 < rejected by protocol 192.168.2.0/24 0L 7G unicast
2023-03-20 02:21:43.243 <TRACE> savnet_ed.ipv4 > added [best] 192.168.3.0/24 0L 7G unicast
2023-03-20 02:21:43.243 <TRACE> savnet_ed.savnet4 < rejected by protocol 192.168.3.0/24 0L 7G unicast
2023-03-20 02:21:43.243 <TRACE> savnet_ed.ipv4 < rejected by protocol 192.168.3.0/24 0L 7G unicast
2023-03-20 02:21:43.243 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.243 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65502"
    ,"interface_name":"e_d"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ed"
    ,"as_path":"65502"
    ,"sav_origin":""
    ,"routes":""
    ,"sav_scope":""
    ,"sav_nlri":""    }}
2023-03-20 02:21:43.243 <TRACE> savnet_ed: Got UPDATE
2023-03-20 02:21:43.243 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:43.243 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:43.243 <TRACE> savnet_ed: Got END-OF-RIB
2023-03-20 02:21:43.243 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.249 <DBG> call_agent
2023-03-20 02:21:43.249 <DBG> SavAgent reply {
  "code": "2000",
  "data": {
    "as_path": "2,1,0,0,255,223",
    "as_path_len": 6,
    "is_interior": 1,
    "next_hop": "4,10,0,7,2",
    "nlri_len": 4,
    "protocol_name": "savnet_ed",
    "sav_nlri": "24,192,168,4",
    "sav_origin": "0,0,255,223",
    "sav_scope": "1,1,0,0,255,222",
    "withdraws": "0,0"
  },
  "message": "success"
}

2023-03-20 02:21:43.249 <DBG> inserting 0,0
2023-03-20 02:21:43.249 <DBG> inserting 4,10,0,7,2
2023-03-20 02:21:43.249 <DBG> inserting 0,0,255,223
2023-03-20 02:21:43.249 <DBG> inserting 1,1,0,0,255,222
2023-03-20 02:21:43.249 <DBG> inserting 24,192,168,4
2023-03-20 02:21:43.249 <DBG> inserting 2,1,0,0,255,223
2023-03-20 02:21:43.249 <DBG> savnet update packet assembled
2023-03-20 02:21:43.249 <DBG> packet len 63
2023-03-20 02:21:43.249 <DBG> call agent send result, 1
2023-03-20 02:21:43.253 <TRACE> savnet_ed: Got UPDATE
2023-03-20 02:21:43.253 <DBG> 
ip_unreach_len: 0
ip_reach_len: 16
2023-03-20 02:21:43.253 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:43.253 <TRACE> savnet_ed.ipv4 > added [best] 192.168.5.0/24 0L 7G unicast
2023-03-20 02:21:43.253 <TRACE> savnet_ed.savnet4 < rejected by protocol 192.168.5.0/24 0L 7G unicast
2023-03-20 02:21:43.253 <TRACE> savnet_ed.ipv4 < rejected by protocol 192.168.5.0/24 0L 7G unicast
2023-03-20 02:21:43.253 <TRACE> savnet_ed.ipv4 > added 10.0.5.0/24 0L 7G unicast
2023-03-20 02:21:43.253 <TRACE> savnet_ed.ipv4 > added [best] 10.0.6.0/24 0L 7G unicast
2023-03-20 02:21:43.253 <TRACE> savnet_ed.savnet4 < rejected by protocol 10.0.6.0/24 0L 7G unicast
2023-03-20 02:21:43.253 <TRACE> savnet_ed.ipv4 < rejected by protocol 10.0.6.0/24 0L 7G unicast
2023-03-20 02:21:43.253 <TRACE> savnet_ed.ipv4 > added [best] 10.0.1.0/24 0L 7G unicast
2023-03-20 02:21:43.253 <TRACE> savnet_ed.savnet4 < rejected by protocol 10.0.1.0/24 0L 7G unicast
2023-03-20 02:21:43.253 <TRACE> savnet_ed.ipv4 < rejected by protocol 10.0.1.0/24 0L 7G unicast
2023-03-20 02:21:43.253 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.253 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65502"
    ,"interface_name":"e_d"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ed"
    ,"as_path":"65502,65504"
    ,"sav_origin":""
    ,"routes":""
    ,"sav_scope":""
    ,"sav_nlri":""    }}
2023-03-20 02:21:43.255 <TRACE> savnet_ed: Got UPDATE
2023-03-20 02:21:43.255 <DBG> 
ip_unreach_len: 0
ip_reach_len: 8
2023-03-20 02:21:43.255 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:43.255 <TRACE> savnet_ed.ipv4 > added [best] 192.168.6.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <TRACE> savnet_ed.savnet4 < rejected by protocol 192.168.6.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <TRACE> savnet_ed.ipv4 < rejected by protocol 192.168.6.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <TRACE> savnet_ed.ipv4 > added [best] 192.168.7.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <TRACE> savnet_ed.savnet4 < rejected by protocol 192.168.7.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <TRACE> savnet_ed.ipv4 < rejected by protocol 192.168.7.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.255 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65502"
    ,"interface_name":"e_d"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ed"
    ,"as_path":"65502,65504,65505"
    ,"sav_origin":""
    ,"routes":""
    ,"sav_scope":""
    ,"sav_nlri":""    }}
2023-03-20 02:21:43.255 <TRACE> ...
2023-03-20 02:21:43.255 <DBG> 
ip_unreach_len: 0
ip_reach_len: 8
2023-03-20 02:21:43.255 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:43.255 <TRACE> savnet_ed.ipv4 > added [best] 192.168.1.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <TRACE> savnet_ed.savnet4 < rejected by protocol 192.168.1.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <TRACE> savnet_ed.ipv4 < rejected by protocol 192.168.1.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <TRACE> savnet_ed.ipv4 > added [best] 10.0.2.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <TRACE> savnet_ed.savnet4 < rejected by protocol 10.0.2.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <TRACE> savnet_ed.ipv4 < rejected by protocol 10.0.2.0/24 0L 7G unicast
2023-03-20 02:21:43.255 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.255 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65502"
    ,"interface_name":"e_d"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ed"
    ,"as_path":"65502,65504,65501"
    ,"sav_origin":""
    ,"routes":""
    ,"sav_scope":""
    ,"sav_nlri":""    }}
2023-03-20 02:21:43.257 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:43.257 <DBG> 
mp_reach_len: 18
mp_unreach_len: 0
2023-03-20 02:21:43.257 <DBG> bgp_decode_nlri_savnet4 len: 18
2023-03-20 02:21:43.257 <DBG> s->sav_origin: [65502]
2023-03-20 02:21:43.257 <DBG> s->sav_scope: [1,1,65503]
2023-03-20 02:21:43.257 <DBG> s->sav_nlri: [24,192,168,2,24,192,168,3]
2023-03-20 02:21:43.257 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.257 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65502"
    ,"interface_name":"e_d"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ed"
    ,"as_path":"65502"
    ,"sav_origin":"65502"
    ,"routes":""
    ,"sav_scope":"1,1,65503"
    ,"sav_nlri":"24,192,168,2,24,192,168,3"    }}
2023-03-20 02:21:43.261 <DBG> call_agent
2023-03-20 02:21:43.261 <DBG> SavAgent reply {
  "code": "2000",
  "data": {
    "as_path": "2,1,0,0,255,223",
    "as_path_len": 6,
    "is_interior": 1,
    "next_hop": "4,10,0,7,2",
    "nlri_len": 4,
    "protocol_name": "savnet_ed",
    "sav_nlri": "24,192,168,4",
    "sav_origin": "0,0,255,223",
    "sav_scope": "2,3,0,0,255,222,0,0,255,224,0,0,255,225,3,0,0,255,222,0,0,255,224,0,0,255,221",
    "withdraws": "0,0"
  },
  "message": "success"
}

2023-03-20 02:21:43.261 <DBG> inserting 0,0
2023-03-20 02:21:43.261 <DBG> inserting 4,10,0,7,2
2023-03-20 02:21:43.261 <DBG> inserting 0,0,255,223
2023-03-20 02:21:43.261 <DBG> inserting 2,3,0,0,255,222,0,0,255,224,0,0,255,225,3,0,0,255,222,0,0,255,224,0,0,255,221
2023-03-20 02:21:43.261 <DBG> inserting 24,192,168,4
2023-03-20 02:21:43.261 <DBG> inserting 2,1,0,0,255,223
2023-03-20 02:21:43.261 <DBG> savnet update packet assembled
2023-03-20 02:21:43.261 <DBG> packet len 84
2023-03-20 02:21:43.261 <DBG> call agent send result, 1
2023-03-20 02:21:43.298 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:43.298 <DBG> 
mp_reach_len: 14
mp_unreach_len: 0
2023-03-20 02:21:43.298 <DBG> bgp_decode_nlri_savnet4 len: 14
2023-03-20 02:21:43.298 <DBG> s->sav_origin: [65504]
2023-03-20 02:21:43.298 <DBG> s->sav_scope: [1,1,65503]
2023-03-20 02:21:43.298 <DBG> s->sav_nlri: [24,192,168,5]
2023-03-20 02:21:43.298 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.298 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65502"
    ,"interface_name":"e_d"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ed"
    ,"as_path":"65504,65502"
    ,"sav_origin":"65504"
    ,"routes":""
    ,"sav_scope":"1,1,65503"
    ,"sav_nlri":"24,192,168,5"    }}
2023-03-20 02:21:43.346 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:43.346 <DBG> 
mp_reach_len: 14
mp_unreach_len: 0
2023-03-20 02:21:43.346 <DBG> bgp_decode_nlri_savnet4 len: 14
2023-03-20 02:21:43.346 <DBG> s->sav_origin: [65501]
2023-03-20 02:21:43.346 <DBG> s->sav_scope: [1,1,65503]
2023-03-20 02:21:43.346 <DBG> s->sav_nlri: [24,192,168,1]
2023-03-20 02:21:43.346 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.346 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65502"
    ,"interface_name":"e_d"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ed"
    ,"as_path":"65501,65504,65502"
    ,"sav_origin":"65501"
    ,"routes":""
    ,"sav_scope":"1,1,65503"
    ,"sav_nlri":"24,192,168,1"    }}
2023-03-20 02:21:43.375 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:43.375 <DBG> 
mp_reach_len: 18
mp_unreach_len: 0
2023-03-20 02:21:43.375 <DBG> bgp_decode_nlri_savnet4 len: 18
2023-03-20 02:21:43.375 <DBG> s->sav_origin: [65505]
2023-03-20 02:21:43.375 <DBG> s->sav_scope: [1,1,65503]
2023-03-20 02:21:43.375 <DBG> s->sav_nlri: [24,192,168,6,24,192,168,7]
2023-03-20 02:21:43.375 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.375 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65502"
    ,"interface_name":"e_d"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ed"
    ,"as_path":"65505,65504,65502"
    ,"sav_origin":"65505"
    ,"routes":""
    ,"sav_scope":"1,1,65503"
    ,"sav_nlri":"24,192,168,6,24,192,168,7"    }}
2023-03-20 02:21:43.382 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:43.382 <DBG> 
mp_reach_len: 14
mp_unreach_len: 0
2023-03-20 02:21:43.382 <DBG> bgp_decode_nlri_savnet4 len: 14
2023-03-20 02:21:43.382 <DBG> s->sav_origin: [65501]
2023-03-20 02:21:43.382 <DBG> s->sav_scope: [1,1,65503]
2023-03-20 02:21:43.382 <DBG> s->sav_nlri: [24,192,168,1]
2023-03-20 02:21:43.382 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:43.382 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65502"
    ,"interface_name":"e_d"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ed"
    ,"as_path":"65501,65505,65504,65502"
    ,"sav_origin":"65501"
    ,"routes":""
    ,"sav_scope":"1,1,65503"
    ,"sav_nlri":"24,192,168,1"    }}
BGP: connect_timeout
BGP: Closing connection
BGP: Connecting
2023-03-20 02:21:43.452 <TRACE> savnet_ec: Connecting to 10.0.5.1 from local address 10.0.5.2
BGP: Waiting for connect success
2023-03-20 02:21:43.452 <TRACE> savnet_ec: Connected
BGP: Sending open
2023-03-20 02:21:43.452 <TRACE> savnet_ec: Sending OPEN(ver=4,as=65503,hold=240,id=0a000502)
2023-03-20 02:21:43.452 <TRACE> savnet_ec: Sending OPEN content Capability Code: 1, AFI: 1,SAFI: 1
2023-03-20 02:21:43.452 <TRACE> savnet_ec: Got OPEN(as=65504,hold=240,id=10.0.1.2)
2023-03-20 02:21:43.452 <TRACE> savnet_ec: Got OPEN content Capability Code: 1, AFI: 1, SAFI: 1
2023-03-20 02:21:43.452 <TRACE> savnet_ec: Sending KEEPALIVE
2023-03-20 02:21:43.452 <TRACE> savnet_ec: Got KEEPALIVE
2023-03-20 02:21:43.452 <TRACE> savnet_ec: BGP session established
2023-03-20 02:21:43.452 <TRACE> savnet_ec: Protocol state changed to up
2023-03-20 02:21:43.452 <DBG> link [savnet_ec] up sent
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 10.0.7.0/24 488L 6G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 192.168.5.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 192.168.6.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 10.0.4.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 192.168.7.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 10.0.5.0/24 484L 5G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 10.0.6.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 192.168.1.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 192.168.2.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 192.168.3.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 10.0.1.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 192.168.4.0/24 0L 4G blackhole
2023-03-20 02:21:43.454 <TRACE> savnet_ec.savnet4 < filtered out 10.0.2.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 10.0.7.0/24 488L 6G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 192.168.5.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 192.168.6.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 10.0.4.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 192.168.7.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 10.0.5.0/24 484L 5G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 10.0.6.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 192.168.1.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 192.168.2.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 192.168.3.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 10.0.1.0/24 0L 7G unicast
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 192.168.4.0/24 0L 4G blackhole
2023-03-20 02:21:43.454 <TRACE> savnet_ec.ipv4 < added 10.0.2.0/24 0L 7G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Sending END-OF-RIB
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Sending UPDATE
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Sending UPDATE
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Sending UPDATE
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Sending UPDATE
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Sending UPDATE
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Sending END-OF-RIB
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Got UPDATE
2023-03-20 02:21:46.456 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:46.456 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Got END-OF-RIB
2023-03-20 02:21:46.456 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Got UPDATE
2023-03-20 02:21:46.456 <DBG> 
ip_unreach_len: 0
ip_reach_len: 20
2023-03-20 02:21:46.456 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 > added [best] 192.168.5.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.savnet4 < filtered out 192.168.5.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.ipv4 < added 192.168.5.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.savnet4 < rejected by protocol 192.168.5.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < rejected by protocol 192.168.5.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < removed 192.168.5.0/24 0L 7G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 > added [best] 10.0.4.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.savnet4 < filtered out 10.0.4.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.ipv4 < added 10.0.4.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.savnet4 < rejected by protocol 10.0.4.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < rejected by protocol 10.0.4.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < removed 10.0.4.0/24 0L 7G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 > added 10.0.5.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 > added [best] 10.0.6.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.savnet4 < filtered out 10.0.6.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.ipv4 < added 10.0.6.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.savnet4 < rejected by protocol 10.0.6.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < rejected by protocol 10.0.6.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < removed 10.0.6.0/24 0L 7G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 > added [best] 10.0.1.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.savnet4 < filtered out 10.0.1.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.ipv4 < added 10.0.1.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.savnet4 < rejected by protocol 10.0.1.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < rejected by protocol 10.0.1.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < removed 10.0.1.0/24 0L 7G unicast
2023-03-20 02:21:46.456 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:46.456 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65504"
    ,"interface_name":"e_b"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ec"
    ,"as_path":"65504"
    ,"sav_origin":""
    ,"routes":""
    ,"sav_scope":""
    ,"sav_nlri":""    }}
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Got UPDATE
2023-03-20 02:21:46.456 <DBG> 
ip_unreach_len: 0
ip_reach_len: 8
2023-03-20 02:21:46.456 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 > added [best] 192.168.6.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.savnet4 < filtered out 192.168.6.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.ipv4 < added 192.168.6.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.savnet4 < rejected by protocol 192.168.6.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < rejected by protocol 192.168.6.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < removed 192.168.6.0/24 0L 7G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 > added [best] 192.168.7.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.savnet4 < filtered out 192.168.7.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.ipv4 < added 192.168.7.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.savnet4 < rejected by protocol 192.168.7.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < rejected by protocol 192.168.7.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < removed 192.168.7.0/24 0L 7G unicast
2023-03-20 02:21:46.456 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:46.456 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65504"
    ,"interface_name":"e_b"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ec"
    ,"as_path":"65504,65505"
    ,"sav_origin":""
    ,"routes":""
    ,"sav_scope":""
    ,"sav_nlri":""    }}
2023-03-20 02:21:46.456 <TRACE> ...
2023-03-20 02:21:46.456 <DBG> 
ip_unreach_len: 0
ip_reach_len: 8
2023-03-20 02:21:46.456 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 > added [best] 192.168.1.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.savnet4 < filtered out 192.168.1.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.ipv4 < added 192.168.1.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.savnet4 < rejected by protocol 192.168.1.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < rejected by protocol 192.168.1.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < removed 192.168.1.0/24 0L 7G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 > added [best] 10.0.2.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.savnet4 < filtered out 10.0.2.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ed.ipv4 < added 10.0.2.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.savnet4 < rejected by protocol 10.0.2.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < rejected by protocol 10.0.2.0/24 0L 8G unicast
2023-03-20 02:21:46.456 <TRACE> savnet_ec.ipv4 < removed 10.0.2.0/24 0L 7G unicast
2023-03-20 02:21:46.456 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:46.456 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65504"
    ,"interface_name":"e_b"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ec"
    ,"as_path":"65504,65501"
    ,"sav_origin":""
    ,"routes":""
    ,"sav_scope":""
    ,"sav_nlri":""    }}
2023-03-20 02:21:46.456 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:46.456 <DBG> 
mp_reach_len: 0
mp_unreach_len: 0
2023-03-20 02:21:46.456 <TRACE> savnet_ec: Got END-OF-RIB
2023-03-20 02:21:46.456 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:46.461 <TRACE> ...
2023-03-20 02:21:46.467 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:46.467 <DBG> 
mp_reach_len: 18
mp_unreach_len: 0
2023-03-20 02:21:46.467 <DBG> bgp_decode_nlri_savnet4 len: 18
2023-03-20 02:21:46.467 <DBG> s->sav_origin: [65504]
2023-03-20 02:21:46.467 <DBG> s->sav_scope: [1,2,65503,65502]
2023-03-20 02:21:46.467 <DBG> s->sav_nlri: [24,192,168,5]
2023-03-20 02:21:46.467 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:46.467 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65504"
    ,"interface_name":"e_b"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ec"
    ,"as_path":"65504"
    ,"sav_origin":"65504"
    ,"routes":""
    ,"sav_scope":"1,2,65503,65502"
    ,"sav_nlri":"24,192,168,5"    }}
2023-03-20 02:21:46.470 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:46.470 <DBG> 
mp_reach_len: 39
mp_unreach_len: 0
2023-03-20 02:21:46.470 <DBG> bgp_decode_nlri_savnet4 len: 39
2023-03-20 02:21:46.470 <DBG> s->sav_origin: [65502]
2023-03-20 02:21:46.470 <DBG> s->sav_scope: [2,3,65503,65504,65505,3,65503,65504,65501]
2023-03-20 02:21:46.470 <DBG> s->sav_nlri: [24,192,168,2,24,192,168,3]
2023-03-20 02:21:46.470 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:46.470 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65502"
    ,"interface_name":"e_d"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ed"
    ,"as_path":"65502"
    ,"sav_origin":"65502"
    ,"routes":""
    ,"sav_scope":"2,3,65503,65504,65505,3,65503,65504,65501"
    ,"sav_nlri":"24,192,168,2,24,192,168,3"    }}
2023-03-20 02:21:46.482 <DBG> call_agent
2023-03-20 02:21:46.482 <DBG> SavAgent reply {
  "code": "2000",
  "data": {
    "as_path": "2,2,0,0,255,224,0,0,255,223",
    "as_path_len": 10,
    "is_interior": 1,
    "next_hop": "4,10,0,7,2",
    "nlri_len": 4,
    "protocol_name": "savnet_ed",
    "sav_nlri": "24,192,168,5",
    "sav_origin": "0,0,255,224",
    "sav_scope": "1,1,0,0,255,222",
    "withdraws": "0,0"
  },
  "message": "success"
}

2023-03-20 02:21:46.482 <DBG> inserting 0,0
2023-03-20 02:21:46.482 <DBG> inserting 4,10,0,7,2
2023-03-20 02:21:46.482 <DBG> inserting 0,0,255,224
2023-03-20 02:21:46.482 <DBG> inserting 1,1,0,0,255,222
2023-03-20 02:21:46.482 <DBG> inserting 24,192,168,5
2023-03-20 02:21:46.482 <DBG> inserting 2,2,0,0,255,224,0,0,255,223
2023-03-20 02:21:46.482 <DBG> savnet update packet assembled
2023-03-20 02:21:46.482 <DBG> packet len 67
2023-03-20 02:21:46.482 <DBG> call agent send result, 1
2023-03-20 02:21:46.483 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:46.483 <DBG> 
mp_reach_len: 18
mp_unreach_len: 0
2023-03-20 02:21:46.483 <DBG> bgp_decode_nlri_savnet4 len: 18
2023-03-20 02:21:46.483 <DBG> s->sav_origin: [65505]
2023-03-20 02:21:46.483 <DBG> s->sav_scope: [1,1,65503]
2023-03-20 02:21:46.483 <DBG> s->sav_nlri: [24,192,168,6,24,192,168,7]
2023-03-20 02:21:46.483 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:46.483 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65504"
    ,"interface_name":"e_b"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ec"
    ,"as_path":"65505,65504"
    ,"sav_origin":"65505"
    ,"routes":""
    ,"sav_scope":"1,1,65503"
    ,"sav_nlri":"24,192,168,6,24,192,168,7"    }}
2023-03-20 02:21:46.488 <DBG> 
ip_unreach_len: 0
ip_reach_len: 0
2023-03-20 02:21:46.488 <DBG> 
mp_reach_len: 14
mp_unreach_len: 0
2023-03-20 02:21:46.488 <DBG> bgp_decode_nlri_savnet4 len: 14
2023-03-20 02:21:46.488 <DBG> s->sav_origin: [65501]
2023-03-20 02:21:46.488 <DBG> s->sav_scope: [1,1,65503]
2023-03-20 02:21:46.488 <DBG> s->sav_nlri: [24,192,168,1]
2023-03-20 02:21:46.488 <DBG> BGP UPDATE PROCESSING FINISHED
2023-03-20 02:21:46.488 <DBG> Sent to SavAgent:{"msg_type":"bgp_update"
,"msg":{
      "neighbor_as":"65504"
    ,"interface_name":"e_b"
    ,"interface_index":"0"
    ,"protocol_name":"savnet_ec"
    ,"as_path":"65501,65505,65504"
    ,"sav_origin":"65501"
    ,"routes":""
    ,"sav_scope":"1,1,65503"
    ,"sav_nlri":"24,192,168,1"    }}
2023-03-20 02:21:46.492 <DBG> call_agent
2023-03-20 02:21:46.492 <DBG> SavAgent reply {
  "code": "2000",
  "data": {
    "as_path": "2,2,0,0,255,222,0,0,255,223",
    "as_path_len": 10,
    "is_interior": 1,
    "next_hop": "4,10,0,5,2",
    "nlri_len": 8,
    "protocol_name": "savnet_ec",
    "sav_nlri": "24,192,168,2,24,192,168,3",
    "sav_origin": "0,0,255,222",
    "sav_scope": "2,2,0,0,255,224,0,0,255,225,2,0,0,255,224,0,0,255,221",
    "withdraws": "0,0"
  },
  "message": "success"
}

2023-03-20 02:21:46.492 <DBG> inserting 0,0
2023-03-20 02:21:46.492 <DBG> inserting 4,10,0,5,2
2023-03-20 02:21:46.492 <DBG> inserting 0,0,255,222
2023-03-20 02:21:46.492 <DBG> inserting 2,2,0,0,255,224,0,0,255,225,2,0,0,255,224,0,0,255,221
2023-03-20 02:21:46.492 <DBG> inserting 24,192,168,2,24,192,168,3
2023-03-20 02:21:46.492 <DBG> inserting 2,2,0,0,255,222,0,0,255,223
2023-03-20 02:21:46.492 <DBG> savnet update packet assembled
2023-03-20 02:21:46.492 <DBG> packet len 84
2023-03-20 02:21:46.492 <DBG> call agent send result, 1
